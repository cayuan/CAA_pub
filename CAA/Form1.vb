

''+++++++++++++++++++++++++oosyhdddddddddddmmmmmmmmNNNNNNNmdmmNNNNNNNNNNNNmddhyhddhdmmmmmmmmmmmmmdddhh
''+++++++++++++++++++++osyhhddddddddmmmmmmmmmmmmmmNNNNNNNNNNNNNNNNNNNNNNNNNNmmddhddmmNNNNNNNNNNNNNNmmm
''++++++++++++++++++oyhddddddddddmmmmmmmmNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNmdddmmmNNNNNNNNNNNNNNNN
''+++++++++++++++ossyddddhhhdddddmmmmmmmmmmmmNNNNNNNNNNNNNNNNNNNNNNNNNNMMMMNNNNNmdmmmmmNNNNNNNNNNNNNNN
''++++++++++++ooosyhhhdddhhhhddddddmmmmNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNMMNNNmmmmmNNNNNNNNNNNNNNN
''o+ooooooooooosyhhhhdddddmmmmddmmmmmmmmNNNNNNNNNNNNNNNmmmmmmNNNNNNNNNNNNNMNNNMMMMNNmmmNNNNNNNNNNNNNNN
''++++++++++ooshhhhddddddhdddddddmmmmmmmNNNNNNNNNNNNNNmmmmmmmmmmNNNNNNNNNNNNNMMMNMNNNNmmmmmmmNmNNNNNNN
''+++++++++++shhdddddddddddmmmddmmmmmNNNNNNNNNNNNNNNmmmmmmmmmmmmNNNNNNNNNNNNNNNNNMNNNNmdhhhhhhhhhhhhhh
''/////////+sdddddddddddddddddmmmmmmmNNNNNNNNNNNNNNmmddddmmmmmmmmNNNNNNNNNNNNMNNNNNNNNmdhsoooooooooooo
''/////////odmmdddddddddddmmmmmmmmmmmmNNNNNNNNNNNNNmdhhddmmmmmmmNNNNNNNNNNNNNNMNNNNNNNNhyy+///////////
'':::::://+dmmNmmddddmdmmmmmmmmmNNNNNmmmmNNNNmmmmmmmmdddmmmmmmNNNNNNNNNNNNNNNNNNNNNNNNNdsy+::::://////
''//:::::/ymmmmmmddddmmmmdmmmmmmNNNNNNNmmmmmdhdhyyhddhhddmmmmmmmNNNNNNNNNNNNNNNNNNNNNNNNho+///////////
''/////:/+mmmdddddddmmdmddmmmmmmNNNNNNNmmdddhyhyssssyyyhhddddmmmmmmNNNNNNNNNNNNNNNNNNNNNm++///////////
''++/////ymdddddddddddmdddmmmmmmmNNmmmmmdhysooso++/++oosssyhhhddmmmmmmNNNNNNNNNNNNNNNmNNNs////////////
''+++///odmddddddmdddddddmmmmmmmmmmmmdhyso+++/////////+osossyyhhhdmmmmmNNNNNNNNNNNNNNNNmNs////////////
''oo+++sddddddddddddddhhddddddmdddhyso+//:::::::::::/+++oooossyhhhdddmmmNNNNNNNNNNNNNNNNdo////////////
''soo+odmmmmmmmmmmmddhyyyhhhhhhyso+//::::------:::::/+++oooosssshhhdddmmmNNNNNNNNNNNNNNmd+////////////
''yssosdNmmmmmmmmmmdhyssysssso+///:::::-------:::::://++ooooosssyhdhdddmmmNNNNNNNNNNNNNNms+///////////
''yyssydNNNmmmmmmmmdhyysooo/////:::----------:::://:/++++oooooossyhddddmmmmmNNNNNNNNNNNNms////////////
''hyysohmmmmmmmmmmdddho++/::::::::-----------::::::://+++++oooossyyhddddmmmmmNNNNNNNNNNNh+////////////
''hhysohmNNmddmmmddddyoo::--:::::------------:::::::////++++ooossyyyhdddmmmmNNNNNNNNNNNNd/////////////
''dhysohmmmdmmmmmmmddys/:-----------------:---::::::://+++++ooossyyyhddddmmmNNNNNNNNNNNNh+/::://://::/
''dhyssohmmmmNNmmdmdhs+:-----------------:---------::/+++++++oossyyhhhddddmmNNNNNNNNNNNmd/::::::::::::
''dhysooyddmNNNNmddhyo/:--------...-.-----------.---://++++++ooossyhhhhhhddmmNNNNNNNNNNhs/::::::::::::
''dhyso+oyyhdmNNmmdhs//-:-.----.......---:------..--::///++ossssssyyyhhhhhhdmNNNNNNmmmdhys/:::::::::::
''dhyso++o++oshdmmmho/::---::://////:::::::----:--::/+ossyyyyyyyyyyyyyyyyhhhmNmmNmdddhhyyyo::::::::---
''hhyso+++::///:/ymd+::-::////++oo+oo+++++/:--:////ossssssoosssyyhhhhyyyyhhdddmNNdddhhhyyys::::::-----
''yysso++/-+o+/:-/dh+::-::------:://++++++/:-:/+o++++////++oossyyyyhhhyyyyyhhdNNNmdhhhyyyys:::::::::--
''ssoo++++:/+/:--:ss::-::///::://+oossyso+/:--/+oo++oo+++++osssyyhhhddhyyhyyyhmNNmdhhhyyys+:::::::::::
''oo+++++++:/+/:-/y+//++:--:::/++oyyhyysoss+/+oyyysooossosyyyhhhhhyyymNmhyssshdmmmdhhhhyso/:::::::::::
''+++++++ooo::+/:+yoyhyo-.--::/+++osssoo/:shssyhdyysoo++oosssyyyyyyyydhyyssssyhhdmdhhhyy+:::::::::::::
''oooooooooss/:///o/-:s/-..--:://++ooo+/::oo/:/ohhyso+++++ooossssssssyyysssssyyydmdhyys/::::::::::::::
''oooooooooooo/-::::---+/-----:://///:::://:--:+syyyso+++++++++++oosysssssssyysydhhhys/:::::::::::::::
''osssssoo+++++/-.-..--.-:::::://///////:---.-:+osssyssoo+++++++++ossssysyyyyysyhyhyy+::::::::::::::::
''oossysoo++///+:.-..--....-----::::::---....-:/+ssssso+///:::::/+oosssyyyyyyssyhhyys:::::::::::::::::
''oossyyso++///++.....---.......----:::--....-:/+osyyys+//::::://++ossyyyyyyysshyyys+:::::::::::::::::
''oosssysso+++++o+-..-----.....---:::::-..`...-:+oossyyso//:::://++ossyyyyyyyys+ooo+::::::::::::::::::
''ooossssssooooooss+++/----..---::::://-.....-:/+oosssyhs+/::////+ossyyyyyyyyyo:::::::::::::::::::::::
''oooosssssssooosssyyys:------::::::::--://:::/+osyssyyyo+//////++osyyyyyyyyyyo////:::::::://:::::::::
''+ooooosssssooooossyyy+-----:::--::-...---://+/++oosssoooo+///++ossyyyyyyyyyy+///////::://///////:::/
''++++ooossssoooooossyys/----::-----.....---:/+//++oosssooooo+++oossyyyyyyyyys/////////:://///////////
''////++ooosssooooosssyys/---------....-----:/+//+oooosssssssso+oossyyyyyyhhyo////////////////////////
''::///++oosssssssssssssss:--------.--------::///oooossssssssys+oossyyyyyyhhyo/////////++++++++++++++/
''::://++ossyyyyyssoooooooo:------------:///++++ssssyyyyysyyyysooossyyyyyhhyhs+/++++++++++++++++++++++
''////++oosssssyysooo+++++++:------:://+ooo+///oooosyyyhhsssssoooosyyyyyhhhhdy+:+ooooooooooooooooooooo
''//+++oossssssssooo+++++++++:-----:/:::/sss//://+ossyyyyssssoooosyyyyyhhhhhmy/:/hsooooooooooooooooooo
''+++++oooooooooooo+++++++++++/---::::--:::+ooosoooosssyyyssssoosyyyyhhhhhydd+:::yhyysoooooooooooooooo
''+++++++++++++++++++++++++++++---::::::::::::/:/+++syhhysssssssyyyyhhhhhhhs/::::ydhhhhsoooooooooooooo
''+++++++//+++++++++++++++++++-`-::-----::////+++ossyyyssssosssyyyhhhhhhhy+::::::ymddyoddyoooooooooooo
''oo++++//////+++++++++++++++/`.:+:--------:://+++oooooooooossyyyyyyhhyyo:::::::+dmmmmshmmdhso++++++oo
''sooo++++////+++++++++++++oo: -+o/---------:://+++++++ooooosyyyyyyyyys/:--::::/hmmmmmymmmmmmdyo+++ooo
''ssooo+++++++++++oossyhhhhhy: -oys-.--::::://++++ooo+++oossyyyyyyys+:----:::::ymmmmNNmmmmmmmmmmdyoooo
''sssoooooossyyhdddmdddhhhhyy: `/hh:..--:://++++ooooo++oooosssssso/-------:--:ymddmNNmmmmmmmmmmNmmmdhs
''hdddddddddddmmmddhhyyyyyyyy/  `sdo-..---:://++++++++++oooooo++:-...-------:ymdyymmmmmmmmmmmNNNNNNNNm
''dddhhhhhhhddddhyyyyyyyyyyyh+   `oy+:------::////+////+++//:-..`...-------:ymdhhdmmmmmmmmmmmNNNNNNNNN
''hhhhhyyhhddddhyyyyyyyyyyyhh/    `/yo/:-------:::::://::-.``````...----.-:ydmhhdmmmmmmmmmmmmmmmNNNNNN
''hhhyhyyyhdddhyyyyyyyyyyyydo/`     .os+/:------------..`````````.......--sddddmmmmmmmmmmmmmmmmmmmmmmm
''hyyyhyyydddhyyyyyyyyyyyyhy+/`      `-oo+/::------.`` ```````````......-odyhddmmmmmmmmmmmmmmmmddddmdd
''yyhhhyyhhdhyyyyyyyyyyyyyho:+`        `-+o+//:-.`     ```````````.....-oddhddddddddmmmmmmmmmmmddmmmmd
''yhhhyyyhhhhyyyyyyyyyyyyhy:-+-           .:+/-`      ```` ``````......+hdhdddddddddmmmmmmmmmddddmmmdd
''hhhhyyyhhhyyyyyssyyyyyyho::+/        `./+:.              ``````...../hhhdddddddddddmmmmmmddddddddddd
''hhhyyyyyhyyyyyyyyyyyyyys+-:o+      `+syyyhh/`          `````.```.`.:yhhhhddddddddddddmmmdddddddddddd
''hhyyyyyyyyyyyyyyyyyyyyyoo//o/     .yyyhhhhhhs.        ``````.`..`.:yhhhhhhdhdddhddddddddddddddddddhh



''`````````````````````````````````````````````````````````````````````.:/:.``````````````````````````
''````````````````````````````````````````````````````````````.````.://-..````````````````````````````
''```````````````````......``....................................:::...```````````````````````````````
''````````````.`..............................................-::-............``..````````````````````
''``````````................................................-/:-...........................```````````
''```````................................................/o//-...............................```.`````
''````...............................................:s-/s/-......................................````
''..................................................:ho+/.............................................
''..........................................-.--:s--sy+:-.............................................
''.....................................-....----yo-+/------...........................................
''..............................--.------------oo/o:-------...........................................
''..............................---------------oy+------------..--....................................
''..........................-------------------/:----------------------------------..--...............
''......................-------------------ss-:+---------------------------------------------.........
''...................---------------:y----:dy-+:-----------------------------------------------.......
''...............-..---------------/sh:---/do:+--------------------------------------------------.....
''..............------------:yy:--/s:+o---/m///----------------------------------------------------..-
''............--------------o/+s:/s:-:y---/h:+:-------------------------------------------------------
''............-------------o+--+ys:---y:-:yy/+--------------------------------------------------------
''...........-------------/+---/do----+s/soy+:-:------------------------------------------------------
''.........--------------:s:--/s/y/---:+o/:ss:-------::-----------------------------------------------
''.......--------://:----o/--/s:-/y:-::--::sy:---::::::-----------------------------------------------
''......--------o+:/s---:y--/s:---oo::--:::+s:::-:::::::-::----::-------------------------------------
''......-------+o---+o:-o+-:y/----/y:::::::/s::::::::::::::::::::::::::::::::::::::-:::---------------
''...----------y:----:-:y:--:++///os:::::::/h::::::::::::::::::::::::::::::::::::::::-:::-------------
''...---------:y-------/s-----::///:-::::::/d::::::::::::::::::::::::::::::::::::::::::-:-------------
''.-----------:y-------s/----::-:::::::::::/h+::::::::::::::::::::::::::::::::::::::::::::------------
''------------/y------/s:--::::::-:::::::::/ss::::::::::::::::::::::::::::::::::::::::::::------------
''------------:y:----:s+-:-:::::::::::::::::ss:::::::::::::::::::::::::::::::::::::::::::::::---------
''------------:y/:--:+s:::::::::::::::::::::sy/:::::::::::::::::::::::::::::::::::::::::::::::--------
''-------------+s:::/y:--:::::::::::::::::::oh+:::::::::::::::::::::::::::::::::::::::::::::----------
''-------------:oo++s/--::::::::::::::::::::/hs::::::::::::::::::::::::::::::::::::::::::::::---------
''---------------://:::-:::::::::::::::::::::sd::::::::::::::::::::::::::::::::::::::::::::-:---------
''-----------:-:-::::::::::::::::::::::::::::/o::::::::::::::::::::::::::::::::::::::::::::::---------
''------:---:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::-----------
''---------::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::-------------
''-:----::::::::--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::----------------
'':::::::::::::-:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::---------------




' The ascii art
'  pure text: https://patorjk.com/software/taag/#p=testall&f=Graffiti&t=test
'  draw by yourself: https://kirilllive.github.io/ASCII_Art_Paint/ascii_paint.html
'
'
'
'
Imports System.Threading
Imports System.IO

'Imports MathNet.Numerics.LinearAlgebra.Double

Imports CAA.CAA


Imports Microsoft.Office.Interop

Public Class Form1


    Public USER As CAA.CAA_USER
    Public WEI() As CAA.CAA_WT
    Dim USERPATH As String


    Public ORDER As CAA.CAA_ORDER
    Public ARTCO As CAA.CAA_ARTCO
    Public INVENTORY As CAA.CAA_INVENTORY
    Public OSARTMJ As CAA.CAA_OSARTMJ
    Public OS_TOOLS As CAA.CAA_OSTOOLS
    Public MACH As CAA.CAA_MachineStatus

#Region "Delegation"
    Public Delegate Sub txt_Delegate(ByVal txt As String)
    Public Sub Addtxt_2_txtText(ByVal txt As String)
        If Me.InvokeRequired Then
            Dim d As New txt_Delegate(AddressOf Addtxt_2_txtText)
            Me.Invoke(d, New Object() {txt})
        Else
            txtOutput.AppendText(txt & Environment.NewLine)
        End If
    End Sub



#End Region



#Region "Form load"


    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles Me.Load
        Dim x As Integer = CAA.CAA_const_structure.KeyWindowStartPosition.form1_x

        Dim y As Integer = CAA.CAA_const_structure.KeyWindowStartPosition.form1_y
        Me.Location = New Point(x, y)
        lblCopyright.Text = CAA.CAA_const_structure.CAA_copyright.copywright
        lblVersion.Text = My.Application.Info.Version.ToString



        initializeMe()

    End Sub



    Private Sub initializeMe()
        Dim s As String = ""

        s = "read profile..."

        ' use profile 
        USER = New CAA.CAA_USER
        USERPATH = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) + "\" +
                                 My.Application.Info.AssemblyName + "\"
        ' the environment only work in form

        USERPATH = CAA.CheckFolderSurfix(USERPATH)
        USER.USER_file_folder = USERPATH

        USER.readMe()

        s = "Profile setup done."
        Addtxt_2_txtText(s)

        'WEI
        ReDim WEI(USER.WeightingFile_Title.Count - 1)
        s = "Weighting reading..."
        Addtxt_2_txtText(s)
        For ii As Integer = 0 To WEI.Count - 1
            WEI(ii) = New CAA_WT
            If USER.WeiFileExists_YesNo(ii) Then
                WEI(ii).defineMefromFile(USER, ii)

                s = USER.WeightingFile_Title(ii) +
                    " is read from file:" +
                    USER.WeightingFile_Name(ii) + "."
                Addtxt_2_txtText(s)
            End If
        Next



        'ORDER
        ORDER = New CAA_ORDER

        'ARTCO
        ARTCO = New CAA_ARTCO

        'INVENTORY
        INVENTORY = New CAA_INVENTORY

        'OSARTMJ
        OSARTMJ = New CAA_OSARTMJ

        'OS_TOOLS
        OS_TOOLS = New CAA_OSTOOLS

        'Machine_Status
        MACH = New CAA_MachineStatus

        picGreen.Visible = False
        picRed.Visible = True

        '---
        ' UI
        '---
        txtWorkDir.Text = USER.Current_Working_Folder

        displayUSER()



        Addtxt_2_txtText("")

    End Sub


    Private Sub checkUSERProfile_Folder(pp As String)

        If Not (IO.Directory.Exists(pp)) Then
            IO.Directory.CreateDirectory(pp)
        End If

    End Sub


    Private Sub clearPB_CR()
        dgvPriceBookWeighting.Columns.Clear()
        dgvPriceBookWeighting.Enabled = True
        Dim width As Double = dgvPriceBookWeighting.Width / (2) - 5
        With dgvPriceBookWeighting
            .ColumnCount = 2
            .ColumnHeadersVisible = True
            .RowHeadersWidth = 4

            .Columns(0).Name = "ID"
            .Columns(0).Width = width * 0.8

            .Columns(1).Name = "Weighting"
            .Columns(1).Width = width
        End With

        dgvCostReportWeighting.Columns.Clear()
        dgvCostReportWeighting.Enabled = True

        With dgvCostReportWeighting
            .ColumnCount = 2
            .ColumnHeadersVisible = True
            .RowHeadersWidth = 4

            .Columns(0).Name = "ID"
            .Columns(0).Width = width * 0.8

            .Columns(1).Name = "Weighting"
            .Columns(1).Width = width
        End With


    End Sub



#End Region




#Region "UI"
    Private Sub cmdExit_Click(sender As Object, e As EventArgs) Handles cmdExit.Click
        Call UnloadMe()
    End Sub

    Private Sub ExitToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles ExitToolStripMenuItem.Click
        Call UnloadMe()
    End Sub

    Private Sub ToolStripMenuItem1_Click(sender As Object, e As EventArgs) Handles ToolStripMenuItem1.Click
        CAA_USR_UI.ShowDialog()

    End Sub

    Private Sub WeightingToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles WeightingToolStripMenuItem.Click
        CAA_Weighting_Modify_UI.ShowDialog()
    End Sub
    Private Sub cmdChangeWeighting_Click(sender As Object, e As EventArgs) Handles cmdChangeWeighting.Click
        CAA_Weighting_Modify_UI.ShowDialog()
    End Sub

    Private Function folderselection() As String
        FolderBrowserDialog1.RootFolder = Environment.SpecialFolder.MyComputer

        FolderBrowserDialog1.ShowDialog()

        Dim folderpath As String = FolderBrowserDialog1.SelectedPath

        If IO.Directory.Exists(folderpath) Then
            Return CheckFolderSurfix(folderpath)
        Else
            Return Nothing
        End If

    End Function
    Private Function read_output_return_full_path(Typ As OpenFileType, Optional workdir As String = "C:\Temp",
                                                        Optional fileDescription As String = "") As String

        Dim filter_string As String
        Select Case Typ
            Case OpenFileType.csv
                filter_string = "csv files (*.csv)|*.csv|All files (*.*)|*.*"
            Case OpenFileType.json
                filter_string = "json files (*.json)|*.json|All files (*.*)|*.*"
            Case Else
                filter_string = "All files (*.*)|*.*"
        End Select


        '? open a file dialog 
        With OpenFileDialog1
            .Multiselect = False
            .CheckFileExists = True
            .ReadOnlyChecked = True
            .InitialDirectory = workdir
            .Filter = filter_string
            .Title = fileDescription
            .ShowDialog()
        End With

        Dim outname As String = ""

        If IO.File.Exists(OpenFileDialog1.FileName) Then
            outname = OpenFileDialog1.FileName
        End If
        Return outname
    End Function
#End Region

#Region "Weighting change"
    Private Sub getUI2USER()
        With USER



            For ii As Integer = 0 To dgvPriceBookWeighting.Rows.Count - 2
                If ii <= .PriceBookWeighting.Count - 1 Then
                    .PriceBookWeighting(ii) = CDbl(Trim(dgvPriceBookWeighting.Rows(ii).Cells(1).Value))
                End If
            Next

            For ii As Integer = 0 To dgvCostReportWeighting.Rows.Count - 2
                If ii <= .CostReportWeighting.Count - 1 Then
                    .CostReportWeighting(ii) = CDbl(Trim(dgvCostReportWeighting.Rows(ii).Cells(1).Value))
                End If
            Next
        End With
    End Sub

    Private Sub displayUSER()
        With USER

            clearPB_CR()
            For ii As Integer = 0 To .PriceBookWeighting.Count - 1
                dgvPriceBookWeighting.Rows.Add()
                dgvPriceBookWeighting.Rows(ii).Cells(0).Value = ii.ToString
                dgvPriceBookWeighting.Rows(ii).Cells(1).Value = .PriceBookWeighting(ii).ToString
            Next

            For ii As Integer = 0 To .CostReportWeighting.Count - 1
                dgvCostReportWeighting.Rows.Add()
                dgvCostReportWeighting.Rows(ii).Cells(0).Value = ii.ToString
                dgvCostReportWeighting.Rows(ii).Cells(1).Value = .CostReportWeighting(ii).ToString
            Next

        End With
    End Sub
    Private Sub cmdWeightingConfirmed_Click(sender As Object, e As EventArgs) Handles cmdWeightingConfirmed.Click
        getUI2USER()
        USER.writeMe()

        Dim s As String
        s = "New weightings are saved and activated."
        Addtxt_2_txtText(s)

    End Sub


#End Region




#Region "Form "



    Private Sub UnloadMe()
        Me.Close()
    End Sub

    Private Sub cmdStop_Click(sender As Object, e As EventArgs) Handles cmdStop.Click
        Stop
    End Sub



#End Region


#Region "working Folder"
    Private Function assignTargetFolder_direct() As String
        Dim Message, Title As String
        Message = "Direct input the target folder "    ' Set prompt.
        Title = "Folder Path"    ' Set title.

        ' Display message, title, and default value.
        Dim folderpath As String = InputBox(Message, Title, "")

        If IO.Directory.Exists(folderpath) Then
            Return CheckFolderSurfix(folderpath)

        Else
            Return Nothing
        End If
    End Function



    Private Sub cmdChangeDir_Click(sender As Object, e As EventArgs) Handles cmdChangeDir.Click
        Dim folderp As String = assignTargetFolder_direct()
        If folderp <> "" Then
            USER.Current_Working_Folder = folderp
            txtWorkDir.Text = folderp
            USER.writeMe()
            Addtxt_2_txtText("Folder changed." + vbNewLine)
        End If
    End Sub


    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim folderp As String = folderselection()
        If folderp <> "" Then
            USER.Current_Working_Folder = folderp
            txtWorkDir.Text = folderp
            USER.writeMe()
        End If
    End Sub


#End Region

#Region "Initial Inputs"


    Private Sub checkImportDone_ShowInpicGreeRed()

        If ORDER.lstORD.Count > 0 And
           ARTCO.lstARTCO.Count > 0 And
           INVENTORY.lstINV.Count > 0 And
           OSARTMJ.lstOSARTMJ.Count > 0 And
           OS_TOOLS.lstOSTools.Count > 0 And
           MACH.lstMACH.Count > 0 Then
            picGreen.Visible = True
            picRed.Visible = False
        Else
            picGreen.Visible = False
            picRed.Visible = True
        End If



    End Sub



#Region "ART-CO"


    Private Sub cmdARTCO_Click(sender As Object, e As EventArgs) Handles cmdARTCO.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        Dim fi As String = read_output_return_full_path(OpenFileType.csv,
                                                        USER.Current_Working_Folder,
                                                        "Open ORDER ORIGINAL CSV")
        If Not (IO.File.Exists(fi)) Then Exit Sub


        If ARTCO.defineMEFromCSV(USER.Current_Working_Folder,
                                 IO.Path.GetFileName(fi)) = 1 Then
            Addtxt_2_txtText("ART-CO read from file: " + IO.Path.GetFileName(fi) + ".")
            Addtxt_2_txtText("ART-CO count= " + ARTCO.lstARTCO.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If

        checkImportDone_ShowInpicGreeRed()


    End Sub
    Private Sub ARTCOToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles ARTCOToolStripMenuItem.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If ARTCO.lstARTCO.Count = 0 Then
            MsgBox("Read ART-CO first. ")
            Exit Sub
        End If



        If ARTCO.exportME2CSV() = 1 Then
            Addtxt_2_txtText("ARTCO exported to file: " + ARTCO.exportedFileName + ".")
            Addtxt_2_txtText("")
        End If
    End Sub


#End Region

#Region "ORDER_Original"


    Private Sub cmdGetOrder_Click(sender As Object, e As EventArgs) Handles cmdGetOrder.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If ARTCO.lstARTCO.Count = 0 Then
            MsgBox("Define ART-CO before start. ")
            Exit Sub
        End If

        Dim fi As String = read_output_return_full_path(OpenFileType.csv,
                                                        USER.Current_Working_Folder,
                                                        "Open ORDER ORIGINAL CSV")
        If Not (IO.File.Exists(fi)) Then Exit Sub

        If ORDER.defineMeFromORIGINALCSV(USER.Current_Working_Folder,
                                      IO.Path.GetFileName(fi),
                                      ARTCO) = 1 Then
            Addtxt_2_txtText("ORDER read from file: " + IO.Path.GetFileName(fi) + ".")
            Addtxt_2_txtText("ORDER count= " + ORDER.lstORD.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If
        checkImportDone_ShowInpicGreeRed()
    End Sub
    Private Sub ORDERORIGINALToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles ORDERORIGINALToolStripMenuItem.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If ORDER.lstORD.Count = 0 Then
            MsgBox("Read order first. ")
            Exit Sub
        End If



        If ORDER.exportMe2CSV() = 1 Then
            Addtxt_2_txtText("ORDER exported to file: " + ORDER.exportedFileName + ".")
            Addtxt_2_txtText("")
        End If
    End Sub

    Private Sub ORDERORIGINALCAAFormatToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles ORDERORIGINALCAAFormatToolStripMenuItem.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If ORDER.lstORD.Count = 0 Then
            MsgBox("Read order first. ")
            Exit Sub
        End If



        If ORDER.exportMe2CSV_CAAFormat() = 1 Then
            Addtxt_2_txtText("ORDER exported to file: " + ORDER.exportedFileName + ".")
            Addtxt_2_txtText("")
        End If
    End Sub



#End Region


#Region "Inventory"


    Private Sub cmdInventory_Click(sender As Object, e As EventArgs) Handles cmdInventory.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If ARTCO.lstARTCO.Count = 0 Then
            MsgBox("Define ART-CO before start. ")
            Exit Sub
        End If

        Dim fi As String = read_output_return_full_path(OpenFileType.csv,
                                                        USER.Current_Working_Folder,
                                                        "INVENTORY CSV")
        If Not (IO.File.Exists(fi)) Then Exit Sub

        If INVENTORY.defineMeFromORIGINALCSV(USER.Current_Working_Folder,
                                      IO.Path.GetFileName(fi),
                                      ARTCO) = 1 Then
            Addtxt_2_txtText("INVENTORY read from file: " + IO.Path.GetFileName(fi) + ".")
            Addtxt_2_txtText("INVENTORY count= " + INVENTORY.lstINV.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If
        checkImportDone_ShowInpicGreeRed()
    End Sub
    Private Sub INVENTORYToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles INVENTORYToolStripMenuItem.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If INVENTORY.lstINV.Count = 0 Then
            MsgBox("Read inventory first. ")
            Exit Sub
        End If



        If INVENTORY.exportMe2CSV_Original() = 1 Then
            Addtxt_2_txtText("INVENTORY exported to file: " + INVENTORY.exportedFileName + ".")
            Addtxt_2_txtText("")
        End If
    End Sub

    Private Sub INVENTORYCAAFormatToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles INVENTORYCAAFormatToolStripMenuItem.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If INVENTORY.lstINV.Count = 0 Then
            MsgBox("Read inventory first. ")
            Exit Sub
        End If



        If INVENTORY.exportMe2CSV() = 1 Then
            Addtxt_2_txtText("INVENTORY exported to file: " + INVENTORY.exportedFileName + ".")
            Addtxt_2_txtText("")
        End If
    End Sub


#End Region

#Region "Machine Status"


    Private Sub cmdMachineStatus_pre_Click(sender As Object, e As EventArgs) Handles cmdMachineStatus_pre.Click

        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If


        Dim fi As String = read_output_return_full_path(OpenFileType.csv,
                                                        USER.Current_Working_Folder,
                                                        "Machine Status CSV")
        If Not (IO.File.Exists(fi)) Then Exit Sub

        If MACH.defineMeFromCSV(USER.Current_Working_Folder,
                                      IO.Path.GetFileName(fi)) = 1 Then
            Addtxt_2_txtText("Machine Status read from file: " + IO.Path.GetFileName(fi) + ".")
            Addtxt_2_txtText("Machine Status count= " + MACH.lstMACH.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If
        checkImportDone_ShowInpicGreeRed()

    End Sub
    Private Sub MACHToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles MACHToolStripMenuItem.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If MACH.lstMACH.Count = 0 Then
            MsgBox("Read inventory first. ")
            Exit Sub
        End If



        If MACH.exportMe2CSV() = 1 Then
            Addtxt_2_txtText("mach exported to file: " + MACH.exportedFileName + ".")
            Addtxt_2_txtText("")
        End If
    End Sub

#End Region




#Region "OS_Tools"


    Private Sub cmdSO_ToolStatus_Click(sender As Object, e As EventArgs) Handles cmdSO_ToolStatus.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        Dim fi As String = read_output_return_full_path(OpenFileType.csv,
                                                        USER.Current_Working_Folder,
                                                        "4 OS_TOOLS")
        If Not (IO.File.Exists(fi)) Then Exit Sub


        If OS_TOOLS.defineMeFromCSV(USER.Current_Working_Folder,
                                 IO.Path.GetFileName(fi)) = 1 Then
            Addtxt_2_txtText("OS-TOOLS read from file: " + IO.Path.GetFileName(fi) + ".")
            Addtxt_2_txtText("OS-TOOLS count= " + OS_TOOLS.lstOSTools.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If
        checkImportDone_ShowInpicGreeRed()

    End Sub
    Private Sub OSToolsToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles OSToolsToolStripMenuItem.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If OS_TOOLS.lstOSTools.Count = 0 Then
            MsgBox("Read OS-TOOLs first. ")
            Exit Sub
        End If



        If OS_TOOLS.exportMe2CSV() = 1 Then
            Addtxt_2_txtText("OS_TOOLS exported to file: " + OS_TOOLS.exportedFileName + ".")
            Addtxt_2_txtText("")
        End If


    End Sub


#End Region




#Region "OS-ART-MJ"


    Private Sub cmdOSARTMJ_Click(sender As Object, e As EventArgs) Handles cmdOSARTMJ.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If



        Dim fi As String = read_output_return_full_path(OpenFileType.csv,
                                                        USER.Current_Working_Folder,
                                                        "2_OS-ART-MJ CSV")
        If Not (IO.File.Exists(fi)) Then Exit Sub

        If OSARTMJ.defineMeFromORIGINALCSV(USER.Current_Working_Folder,
                                      IO.Path.GetFileName(fi)) = 1 Then
            Addtxt_2_txtText("OSARTMJ read from file: " + IO.Path.GetFileName(fi) + ".")
            Addtxt_2_txtText("OSARTMJ count= " + OSARTMJ.lstOSARTMJ.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If
        checkImportDone_ShowInpicGreeRed()
    End Sub
    Private Sub OSARTMJToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles OSARTMJToolStripMenuItem.Click
        If txtWorkDir.Text = "" Then
            MsgBox("Assgin the WorkDir first. ")
            Exit Sub
        End If

        If OSARTMJ.lstOSARTMJ.Count = 0 Then
            MsgBox("Read OS-ART-MJ first. ")
            Exit Sub
        End If



        If OSARTMJ.exportMe2CSV() = 1 Then
            Addtxt_2_txtText("OSARTMJ exported to file: " + OSARTMJ.exportedFileName + ".")
            Addtxt_2_txtText("")
        End If

    End Sub
    Private Sub cmdSuper_Click(sender As Object, e As EventArgs) Handles cmdSuper.Click

        '? @@num:1 : ARTCO
        Dim fi As String

        fi = "1_ART_COLOR.csv"
        If ARTCO.defineMEFromCSV(USER.Current_Working_Folder,
                                 "1_ART_COLOR.csv") = 1 Then
            Addtxt_2_txtText("ART-CO read from file: " + fi + ".")
            Addtxt_2_txtText("ART-CO count= " + ARTCO.lstARTCO.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If

        '? @@num:2 : OS-ART-MJ
        fi = "2_OS_ART_MJ.csv"
        If OSARTMJ.defineMeFromORIGINALCSV(USER.Current_Working_Folder,
                                     fi) = 1 Then
            Addtxt_2_txtText("OSARTMJ read from file: " + fi + ".")
            Addtxt_2_txtText("OSARTMJ count= " + OSARTMJ.lstOSARTMJ.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If

        '? @@num:3 : OS_TOOLS
        fi = "3_OS_Tools.csv"
        If OS_TOOLS.defineMeFromCSV(USER.Current_Working_Folder,
                                 fi) = 1 Then
            Addtxt_2_txtText("OS-TOOLS read from file: " + fi + ".")
            Addtxt_2_txtText("OS-TOOLS count= " + OS_TOOLS.lstOSTools.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If


        '? @@num:4 : INVENTORY
        fi = "4_INVENTORY.csv"
        If INVENTORY.defineMeFromORIGINALCSV(USER.Current_Working_Folder,
                                     fi,
                                     ARTCO) = 1 Then
            Addtxt_2_txtText("INVENTORY read from file: " + fi + ".")
            Addtxt_2_txtText("INVENTORY count= " + INVENTORY.lstINV.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If

        '? @@num:5 : MACH
        fi = "5_MACH.csv"
        If MACH.defineMeFromCSV(USER.Current_Working_Folder,
                                     fi) = 1 Then
            Addtxt_2_txtText("Machine Status read from file: " + fi + ".")
            Addtxt_2_txtText("Machine Status count= " + MACH.lstMACH.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If

        '? @@num:6 : ORDER
        fi = "6_ORDER_ORIGINAL.csv"
        If ORDER.defineMeFromORIGINALCSV(USER.Current_Working_Folder,
                                     fi,
                                     ARTCO) = 1 Then
            Addtxt_2_txtText("ORDER read from file: " + fi + ".")
            Addtxt_2_txtText("ORDER count= " + ORDER.lstORD.Count.ToString + ".")
            Addtxt_2_txtText("")
        End If



        checkImportDone_ShowInpicGreeRed()



    End Sub



#End Region

#End Region
#Region "Initialization after data input"
    Private Sub cmdInitialization_Click(sender As Object, e As EventArgs) Handles cmdInitialization.Click

        '? @@num:1  Register the os in the MACH 2 the OS_Tools

        If picRed.Visible = True Then Exit Sub

        For ii As Integer = 0 To MACH.lstMACH.Count - 1
            Dim ma As MACH = MACH.lstMACH(ii)
            If OS_TOOLS.assignToolStatus(ma.OS, ma.SN1, ma.SN2, MachineToolStatus.Available_Plan_inUse) = 1 Then
                Dim s As String = ""
                s += "LINE " + ii.ToString + ","
                s += "OS=" + ma.OS + ","
                s += "SN1=" + ma.SN1 + ","
                s += "SN2=" + ma.SN2
                s += vbNewLine + "Set to Available Plan In USE."
                Addtxt_2_txtText(s)
            End If
        Next



    End Sub



#End Region


#Region "TEst"
    Private Sub cmdtest_Click(sender As Object, e As EventArgs) Handles cmdtest.Click

        'test read

        'WEI(0).defineMefromFile(USER.Base_Data_Folder,
        '                        0,
        '                        USER.WeightingFile_Type(0),
        '                        USER.WeightingFile_Title(0),
        '                        USER.WeightingFile_Name(0))


        'WEI(1).defineMefromFile(USER.Base_Data_Folder,
        '                        1,
        '                        USER.WeightingFile_Type(1),
        '                        USER.WeightingFile_Title(1),
        '                        USER.WeightingFile_Name(1))


        'WEI(0).defineMefromFile(USER, 0)
        'WEI(1).defineMefromFile(USER, 1)



        'WEI(0).exportMe2File("Test.csv")
    End Sub





#End Region






End Class
